#import Test from "../test"
#import Std from "../std"

Test.test "string.valueBetween", function ()
    Test.expect("root:123".valueBetween("root:")).toBe("123")
    Test.expect("root:123\n".valueBetween("root:")).toBe("123")
	Test.expect("root:123".LF.valueBetween("root:")).toBe("123")
end function

Test.test "string.valuesBetween", function ()
    str = "import_cod"+"e(""/root/lib/lib"")""\nimport_"+"code(""/root/lib/std"")""\n"
    valuesBetween = str.valuesBetween("import_cod"+"e(""", """")
	Test.expect(valuesBetween.len).toBe(2)
	Test.expect(valuesBetween[0]).toBe("/root/lib/lib")
	Test.expect(valuesBetween[1]).toBe("/root/lib/std")
end function

Test.test "string.f", function ()
    Test.expect("Hi, $!".f("John")).toBe("Hi, John!")
    Test.expect("$ $ $".f("Hi", 5, null)).toBe("Hi 5 null")
end function

Test.test "string.ensureSuffix", function ()
    Test.expect("file".ensureSuffix(".src")).toBe("file.src")
    Test.expect("file.src".ensureSuffix(".src")).toBe("file.src")
    Test.expect("test".ensureSuffix("test")).toBe("test")
end function

Test.test "string.ensurePrefix", function ()
    Test.expect("file".ensurePrefix("/")).toBe("/file")
    Test.expect("/file".ensurePrefix("/")).toBe("/file")
    Test.expect("test".ensurePrefix("test")).toBe("test")
end function

Test.test "string.removeSuffix", function ()
    Test.expect("file.src".removeSuffix(".src")).toBe("file")
    Test.expect("file".removeSuffix(".src")).toBe("file")
    Test.expect("test".removeSuffix("test")).toBe("")
end function

Test.test "string.removePrefix", function ()
    Test.expect("/file".removePrefix("/")).toBe("file")
    Test.expect("file".removePrefix("/")).toBe("file")
    Test.expect("test".removePrefix("test")).toBe("")
end function

Test.test "string.padLeft", function ()
    Test.expect("5".padLeft(3, "0")).toBe("005")
    Test.expect("5".padLeft(3)).toBe("  5")
end function

Test.test "string.padRight", function ()
    Test.expect("5".padRight(3, "0")).toBe("500")
    Test.expect("5".padRight(3)).toBe("5  ")
end function

Test.test "string.trim", function ()
    Test.expect("  Hi  ".trim()).toBe("Hi")
    Test.expect("  Hi  \n ".LF.trim()).toBe("Hi")
end function

Test.test "string.join", function ()
    Test.expect("/root".join("lib", "file.txt")).toBe("/root/lib/file.txt")
end function

Test.test "string.parent", function ()
    Test.expect("/root/utils".parent()).toBe("/root")
    Test.expect("/root".parent()).toBe("/")
    Test.expect("/".parent()).toBe("/")
end function

Test.test "string.filename", function ()
    Test.expect("/root/utils".filename()).toBe("utils")
    Test.expect("/root".filename()).toBe("root")
    Test.expect("/".filename()).toBe("")
end function

Test.test "string.absolutePath", function ()
    Test.expect("/root/utils".absolutePath()).toBe("/root/utils")
    Test.expect("/root".absolutePath()).toBe("/root")
    Test.expect("/".absolutePath()).toBe("/")

    bkp_current_path = @current_path
    globals.current_path = function ()
        return "/root"
    end function
    Test.expect("utils".absolutePath()).toBe("/root/utils")
    globals.current_path = @bkp_current_path
end function

Test.test "string.has", function ()
    Test.expect("root".has("root")).toBe(true)
    Test.expect("root".has("roo")).toBe(true)
    Test.expect("root".has("r")).toBe(true)
    Test.expect("root".has("")).toBe(true)
end function

Test.test "Std.toString", function ()
    Test.expect(Std.toString(null)).toBe("null")
    Test.expect(Std.toString("test")).toBe("test")
    Test.expect(Std.toString(5)).toBe("5")
    Test.expect(Std.toString([1,2,3])).toBe("[1, 2, 3]")
end function



Test.runTests()
